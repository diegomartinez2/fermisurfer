%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,pdftex,openany,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage[english]{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}



\title{Fermisurfer Documentation}
\date{Aug 18, 2023}
\release{2.4.0}
\author{kawamura}
\newcommand{\sphinxlogo}{\sphinxincludegraphics{fermisurfer.png}\par}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxstepscope


\chapter{Introduction}
\label{\detokenize{overview:introduction}}\label{\detokenize{overview::doc}}
\sphinxAtStartPar
This document is a manual for the Fermi surface drawing program
“FermiSurfer”. FermiSurfer has been developed since 2012 by Mitsuaki
Kawamura (ISSP, The University of Tokyo); it is opened on web at
November, 2014. It draws Fermi surfaces, and plot \(k\)\sphinxhyphen{}depend matrix
elements such as the superconducting gap and orbital character with
colors.

\sphinxstepscope


\chapter{Directories and important files}
\label{\detokenize{file:directories-and-important-files}}\label{\detokenize{file::doc}}\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{\sphinxcode{\sphinxupquote{doc/}}}{[}Directory for manuals{]}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{doc/index.html}} : Index page

\end{itemize}

\end{description}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{examples/}} : Directory for samples

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{src/}} : Directory for source code

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{configure}} : Configuration script for build

\end{itemize}

\sphinxstepscope


\chapter{Install}
\label{\detokenize{install:install}}\label{\detokenize{install::doc}}

\section{Installation in Linux and macOS}
\label{\detokenize{install:installation-in-linux-and-macos}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Install the required package
\begin{itemize}
\item {} 
\sphinxAtStartPar
For Debian/Ubuntu

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }sudo\PYG{+w}{ }aptitude\PYG{+w}{ }install\PYG{+w}{ }libwxgtk3.0\PYGZhy{}dev
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
For Red Hat Enterprise Linux/CentOS

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }sudo\PYG{+w}{ }yum\PYG{+w}{ }install\PYG{+w}{ }wxGTK3\PYGZhy{}devel.x86\PYGZus{}64
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
macOS (Homebrew)

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }brew\PYG{+w}{ }install\PYG{+w}{ }wxmac
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
macOS (Mac Ports)

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }port\PYG{+w}{ }install\PYG{+w}{ }wxWidgets\PYGZhy{}3.0
\end{sphinxVerbatim}

\end{itemize}

\item {} 
\sphinxAtStartPar
Install

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }./configure
\PYGZdl{}\PYG{+w}{ }make
\PYGZdl{}\PYG{+w}{ }sudo\PYG{+w}{ }make\PYG{+w}{ }install
\end{sphinxVerbatim}

\end{enumerate}

\sphinxAtStartPar
Then a binary file \sphinxcode{\sphinxupquote{src/fermisurfer}} is generated and
copied into \sphinxcode{\sphinxupquote{/usr/local/bin/}}.


\section{Installation in Windows}
\label{\detokenize{install:installation-in-windows}}
\sphinxAtStartPar
Download the binary file.

\sphinxAtStartPar
Alternatively, we can build FermiSurfer by ourselves
after we install wxWidgets library.
We can use \sphinxcode{\sphinxupquote{fermisurfer.vcxproj}} together with VisualStudio.

\sphinxstepscope


\chapter{Input file}
\label{\detokenize{input:input-file}}\label{\detokenize{input:input}}\label{\detokenize{input::doc}}

\section{input\sphinxhyphen{}file format}
\label{\detokenize{input:input-file-format}}
\sphinxAtStartPar
You have to prepare following data:
\begin{itemize}
\item {} 
\sphinxAtStartPar
The number of \(k\) grid (three direction)

\item {} 
\sphinxAtStartPar
Reciprocal lattice vectors

\item {} 
\sphinxAtStartPar
The number of bands

\item {} 
\sphinxAtStartPar
The orbital energy at each band and \(k\) (We call it “energy”) .

\item {} 
\sphinxAtStartPar
Variables that you want to plot with color (We call it “matrix
elements”).

\end{itemize}

\sphinxAtStartPar
The input file is as follows (\sphinxcode{\sphinxupquote{mgb2\_vfz.fs}}):

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{40}          \PYG{l+m+mi}{40}          \PYG{l+m+mi}{36}        \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{l+m+mi}{0}                                 \PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{l+m+mi}{3}                                 \PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{l+m+mf}{1.0000000}      \PYG{l+m+mf}{0.57735026}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.0000000} \PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{l+m+mf}{0.0000000}       \PYG{l+m+mf}{1.1547005}       \PYG{l+m+mf}{0.0000000} \PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{l+m+mf}{0.0000000}      \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.0000000}      \PYG{l+m+mf}{0.87206507} \PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}
\PYG{l+m+mf}{2.91340202E\PYGZhy{}02}                            \PYG{p}{(}\PYG{l+m+mi}{7}\PYG{p}{)}
\PYG{l+m+mf}{2.93242838E\PYGZhy{}02}
\PYG{l+m+mf}{2.98905596E\PYGZhy{}02}
\PYG{l+m+mf}{3.08193434E\PYGZhy{}02}
\PYG{p}{:}
\PYG{p}{:}
\PYG{l+m+mf}{0.14393796}
\PYG{l+m+mf}{0.12800488}
\PYG{l+m+mf}{0.0000000}                                 \PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{)}
\PYG{l+m+mf}{0.36269817}
\PYG{l+m+mf}{0.71675694}
\PYG{l+m+mf}{1.0535113}
\PYG{l+m+mf}{1.3644149}
\PYG{p}{:}
\PYG{p}{:}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{26.409407}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{19.318560}
\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{10.315671}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
The number of \(k\) in each direction

\item {} 
\sphinxAtStartPar
Switch to specify type of \(k\) grid (Choose from \sphinxcode{\sphinxupquote{0, 1, 2}})

\sphinxAtStartPar
\(k\) grid is represented as follows:
\begin{equation*}
\begin{split}\begin{align} {\boldsymbol k}_{i,j,k} =
x_i {\boldsymbol b}_1 + y_j {\boldsymbol b}_2 + z_k {\boldsymbol b}_3,
\end{align}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(i, j, k = 1 \cdots N_1, 1 \cdots N_2, 1 \cdots N_3\) , and
\(N_1, N_2, N_3\) are the number of \(k\) in each direction.

\sphinxAtStartPar
\(x_i, y_j,z_k\) can be chosen from below:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{0}} (Monkhorst\sphinxhyphen{}Pack grid) : \(x_i = \frac{2 i - 1 - N_1}{2 N_1}\)

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{1}} : \(x_i = \frac{i - 1}{N_1}\)

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{2}} : \(x_i = \frac{2 i - 1}{2 N_1}\)

\end{itemize}

\item {} 
\sphinxAtStartPar
The number of bands

\item {} 
\sphinxAtStartPar
Reciprocal lattice vector 1 (arbitrary unit)

\item {} 
\sphinxAtStartPar
Reciprocal lattice vector 2

\item {} 
\sphinxAtStartPar
Reciprocal lattice vector 3

\item {} 
\sphinxAtStartPar
Energy (The order of component is written in  {\hyperref[\detokenize{input:format}]{\sphinxcrossref{\DUrole{std,std-ref}{How to produce the input file in C and fortran programs}}}} )

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{fermisurfer}} assume that the Fermi energy is \sphinxcode{\sphinxupquote{0.0}} in the
default. You can shift the Fermi energy by using
\sphinxcode{\sphinxupquote{Shift Fermi Energy}} menu described at the section 6.5.

\item {} 
\sphinxAtStartPar
Matrix elements (The order of component is written in  {\hyperref[\detokenize{input:format}]{\sphinxcrossref{\DUrole{std,std-ref}{How to produce the input file in C and fortran programs}}}} )

\sphinxAtStartPar
Same as the energy, but in this case we can
write 0 to 3 blocks for this quantity, i.e.
we can omit to write this.

\end{enumerate}


\section{BXSF format}
\label{\detokenize{input:bxsf-format}}
\sphinxAtStartPar
The BXSF format also can be treated by FermiSurfer.
In this case this program behaves as “Matrix elements” are omitted.


\section{How to produce the input file in C and fortran programs}
\label{\detokenize{input:how-to-produce-the-input-file-in-c-and-fortran-programs}}\label{\detokenize{input:format}}
\sphinxAtStartPar
fortran

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{! Resiplocal lattice vector}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}\PYG{+w}{ }\PYG{c}{! k\PYGZhy{}grid of each direction}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{ishift}\PYG{+w}{ }\PYG{c}{! 1 for shifted grid, 0 for unshifted grid.}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{+w}{ }\PYG{c}{! The number of bands}
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{eig}\PYG{p}{(}\PYG{n}{nk3}\PYG{p}{,}\PYG{n}{nk2}\PYG{p}{,}\PYG{n}{nk1}\PYG{p}{,}\PYG{n}{nbnd}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{! energy}
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{(}\PYG{n}{nk3}\PYG{p}{,}\PYG{n}{nk2}\PYG{p}{,}\PYG{n}{nk1}\PYG{p}{,}\PYG{n}{nbnd}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{! matrix element}

\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{ik1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ibnd}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fo}

\PYG{k}{open}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}sample.fs\PYGZdq{}}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{ishift}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec2}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec3}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{do }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{+w}{   }\PYG{k}{do }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk1}
\PYG{+w}{      }\PYG{k}{do }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}
\PYG{+w}{         }\PYG{k}{do }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{+w}{            }\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{ik3}\PYG{p}{,}\PYG{n}{ik2}\PYG{p}{,}\PYG{n}{ik1}\PYG{p}{,}\PYG{n}{ibnd}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{         }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{      }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{   }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{end }\PYG{k}{do}
\PYG{k}{do }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{+w}{   }\PYG{k}{do }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk1}
\PYG{+w}{      }\PYG{k}{do }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}
\PYG{+w}{         }\PYG{k}{do }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{+w}{            }\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{x}\PYG{p}{(}\PYG{n}{ik3}\PYG{p}{,}\PYG{n}{ik2}\PYG{p}{,}\PYG{n}{ik1}\PYG{p}{,}\PYG{n}{ibnd}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{         }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{      }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{   }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{end }\PYG{k}{do}
\PYG{k}{close}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
C

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c+cm}{/*Resiplocal lattice vector*/}
\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}\PYG{p}{;}\PYG{+w}{ }\PYG{c+cm}{/*k\PYGZhy{}grid of each direction*/}
\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{ishift}\PYG{p}{;}\PYG{+w}{ }\PYG{c+cm}{/*1 for shifted grid, 0 for unshifted grid.*/}
\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{p}{;}\PYG{+w}{ }\PYG{c+cm}{/*The number of bands*/}
\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{eig}\PYG{p}{[}\PYG{n}{nbnd}\PYG{p}{]}\PYG{p}{[}\PYG{n}{nk1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{nk2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{nk3}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c+cm}{/*Energy*/}
\PYG{k+kt}{float}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{[}\PYG{n}{nbnd}\PYG{p}{]}\PYG{p}{[}\PYG{n}{nk1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{nk2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{nk3}\PYG{p}{]}\PYG{p}{;}\PYG{+w}{ }\PYG{c+cm}{/*Matrix element*/}

\PYG{k+kt}{FILE}\PYG{o}{*}\PYG{+w}{ }\PYG{n}{fo}\PYG{p}{;}
\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{ibnd}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik3}\PYG{p}{;}

\PYG{n}{fo}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fopen}\PYG{p}{(}\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{sample.frmsf}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{w}\PYG{l+s}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d \PYGZpc{}d \PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{iswitch}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}e \PYGZpc{}e \PYGZpc{}e}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}e \PYGZpc{}e \PYGZpc{}e}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}e \PYGZpc{}e \PYGZpc{}e}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ibnd}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{   }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ik1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ik2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{         }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nk3}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ik3}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}e}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{eig}\PYG{p}{[}\PYG{n}{ibnd}\PYG{p}{]}\PYG{p}{[}\PYG{n}{ik1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{ik2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{ik3}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{         }\PYG{p}{\PYGZcb{}}
\PYG{+w}{      }\PYG{p}{\PYGZcb{}}
\PYG{+w}{   }\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ibnd}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{   }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ik1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{      }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ik2}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{         }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{nk3}\PYG{p}{;}\PYG{+w}{ }\PYG{o}{+}\PYG{o}{+}\PYG{n}{ik3}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{ierr}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{fprintf}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{\PYGZpc{}e}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s}{\PYGZdq{}}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{[}\PYG{n}{ibnd}\PYG{p}{]}\PYG{p}{[}\PYG{n}{ik1}\PYG{p}{]}\PYG{p}{[}\PYG{n}{ik2}\PYG{p}{]}\PYG{p}{[}\PYG{n}{ik3}\PYG{p}{]}\PYG{p}{)}\PYG{p}{;}
\PYG{+w}{         }\PYG{p}{\PYGZcb{}}
\PYG{+w}{      }\PYG{p}{\PYGZcb{}}
\PYG{+w}{   }\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{fclose}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}


\section{For the 2D color plot (See srvo3\_t2g.frmsf in examples)}
\label{\detokenize{input:for-the-2d-color-plot-see-srvo3-t2g-frmsf-in-examples}}
\sphinxAtStartPar
fortran

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{!Resiplocal lattice vector}
\PYG{k+kt}{INTEGER}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}\PYG{+w}{ }\PYG{c}{!k\PYGZhy{}grid of each direction}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{ishift}\PYG{+w}{ }\PYG{c}{!1 for shifted grid, 0 for unshifted grid.}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{+w}{ }\PYG{c}{!The number of bands}
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{eig}\PYG{p}{(}\PYG{n}{nk3}\PYG{p}{,}\PYG{n}{nk2}\PYG{p}{,}\PYG{n}{nk1}\PYG{p}{,}\PYG{n}{nbnd}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{!energy}
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{x}\PYG{p}{(}\PYG{n}{nk3}\PYG{p}{,}\PYG{n}{nk2}\PYG{p}{,}\PYG{n}{nk1}\PYG{p}{,}\PYG{n}{nbnd}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{!matrix element (2D or complex)}

\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{ik1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ibnd}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ii}

\PYG{k}{open}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}sample.frmsf\PYGZdq{}}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{ishift}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec2}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec3}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{do }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{+w}{   }\PYG{k}{do }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk1}
\PYG{+w}{      }\PYG{k}{do }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}
\PYG{+w}{         }\PYG{k}{do }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{+w}{            }\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{ik3}\PYG{p}{,}\PYG{n}{ik2}\PYG{p}{,}\PYG{n}{ik1}\PYG{p}{,}\PYG{n}{ibnd}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{         }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{      }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{   }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{end }\PYG{k}{do}
\PYG{k}{do }\PYG{n}{ii}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{l+m+mi}{2}
\PYG{+w}{   }\PYG{k}{do }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{+w}{      }\PYG{k}{do }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk1}
\PYG{+w}{         }\PYG{k}{do }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}
\PYG{+w}{            }\PYG{k}{do }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{+w}{               }\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{x}\PYG{p}{(}\PYG{n}{ik3}\PYG{p}{,}\PYG{n}{ik2}\PYG{p}{,}\PYG{n}{ik1}\PYG{p}{,}\PYG{n}{ibnd}\PYG{p}{,}\PYG{n}{ii}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{            }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{         }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{      }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{   }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{close}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Omit the quantity for the color plot}
\label{\detokenize{input:omit-the-quantity-for-the-color-plot}}
\sphinxAtStartPar
fortran

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{bvec1}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec2}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{bvec3}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{! Resiplocal lattice vector}
\PYG{k+kt}{INTEGER}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}\PYG{+w}{ }\PYG{c}{! k\PYGZhy{}grid of each direction}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{ishift}\PYG{+w}{ }\PYG{c}{! 1 for shifted grid, 0 for unshifted grid.}
\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{nbnd}\PYG{+w}{ }\PYG{c}{! The number of bands}
\PYG{k+kt}{real}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{eig}\PYG{p}{(}\PYG{n}{nk3}\PYG{p}{,}\PYG{n}{nk2}\PYG{p}{,}\PYG{n}{nk1}\PYG{p}{,}\PYG{n}{nbnd}\PYG{p}{)}\PYG{+w}{ }\PYG{c}{! energy}

\PYG{k+kt}{integer}\PYG{+w}{ }\PYG{k+kd}{::}\PYG{+w}{ }\PYG{n}{ik1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ik3}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ibnd}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{ii}

\PYG{k}{open}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{+w}{ }\PYG{k}{file}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+s+s2}{\PYGZdq{}sample.frmsf\PYGZdq{}}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nk1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{ishift}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec1}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec2}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{bvec3}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\PYG{k}{do }\PYG{n}{ibnd}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nbnd}
\PYG{+w}{   }\PYG{k}{do }\PYG{n}{ik1}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk1}
\PYG{+w}{      }\PYG{k}{do }\PYG{n}{ik2}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk2}
\PYG{+w}{         }\PYG{k}{do }\PYG{n}{ik3}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{nk3}
\PYG{+w}{            }\PYG{k}{write}\PYG{p}{(}\PYG{n}{fo}\PYG{p}{,}\PYG{o}{*}\PYG{p}{)}\PYG{+w}{ }\PYG{k+kt}{real}\PYG{p}{(}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{ik3}\PYG{p}{,}\PYG{n}{ik2}\PYG{p}{,}\PYG{n}{ik1}\PYG{p}{,}\PYG{n}{ibnd}\PYG{p}{)}\PYG{p}{)}
\PYG{+w}{         }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{      }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{   }\PYG{k}{end }\PYG{k}{do}
\PYG{k}{end }\PYG{k}{do}
\end{sphinxVerbatim}

\sphinxstepscope


\chapter{Control FermiSurfer}
\label{\detokenize{ops:control-fermisurfer}}\label{\detokenize{ops:ops}}\label{\detokenize{ops::doc}}

\section{Launch}
\label{\detokenize{ops:launch}}

\subsection{For Linux, Unix, Mac}
\label{\detokenize{ops:for-linux-unix-mac}}
\sphinxAtStartPar
You can launch generated executable as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }fermisurfer\PYG{+w}{ }mgb2\PYGZus{}vfz.fs
\end{sphinxVerbatim}

\sphinxAtStartPar
You need a space between the command and input\sphinxhyphen{}file name.
(The sample input file \sphinxcode{\sphinxupquote{mgb2\_vfz.fs}} contains \(z\) element of
the Fermi velocity in MgB$_{\text{2}}$.)


\subsection{For Windows}
\label{\detokenize{ops:for-windows}}
\sphinxAtStartPar
Click mouse right button on the input file. Choose “Open With …” menu,
then choose \sphinxcode{\sphinxupquote{fermisurfer.exe}}.

\sphinxAtStartPar
Then, Operations are printed, and Fermi surfaces are drawn (Fig. \ref{ops:startpng}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{start}.png}
\caption{Main view.}\label{\detokenize{ops:id1}}\label{\detokenize{ops:startpng}}\end{figure}

\sphinxAtStartPar
The following operations are available:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Rotation of objects with mouse drag

\item {} 
\sphinxAtStartPar
Expand and shrink with mouse wheel

\item {} 
\sphinxAtStartPar
Window re\sphinxhyphen{}sizing

\item {} 
\sphinxAtStartPar
Moving objects with cursor keys (wasd for Windows).
Also we can shift objects with double click.

\item {} 
\sphinxAtStartPar
Opeerate by using the panel

\end{itemize}

\sphinxAtStartPar
Here, we can see all menus.

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Some operations are not applied immidiately, and
after th “Update” button is pushed they are applied.
Such operations are refered as “Update required”.
\end{sphinxadmonition}


\section{Background color}
\label{\detokenize{ops:background-color}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Background (RGB)}} : The background color is specified as RGB.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{background}.png}
\end{figure}


\section{Line width}
\label{\detokenize{ops:line-width}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Line width}} : Modify the width of the Brillouin\sphinxhyphen{}zone boundary, the nodal line, etc.


\section{Line color}
\label{\detokenize{ops:line-color}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Line color (RGB)}} : The line color is specified with RGB.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{line_color}.png}
\end{figure}


\section{Band}
\label{\detokenize{ops:band}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Band 0, RGB}}, \sphinxcode{\sphinxupquote{Band 1, RGB}} … : It makes each band enable/disable (Fig. \ref{ops:bandpng}).

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{band}.png}
\end{figure}


\section{Brillouin zone (Update required)}
\label{\detokenize{ops:brillouin-zone-update-required}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Brillouin zone}} : We choose Brillouin\sphinxhyphen{}zone type as follows (Fig. \ref{ops:brillouinzonepng}):
\begin{description}
\sphinxlineitem{First Brillouin Zone}
\sphinxAtStartPar
The region surrounded by Bragg’s planes the
nearest to \({\rm \Gamma}\) point.

\sphinxlineitem{Primitive Brillouin Zone}
\sphinxAtStartPar
A hexahedron whose corner is the reciprocal
lattice point.

\end{description}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{brillouinzone}.png}
\caption{You can change the type of the Brillouin zone with
“Brillouin zone” menu.}\label{\detokenize{ops:id2}}\label{\detokenize{ops:brillouinzonepng}}\end{figure}


\section{Number of Brillouin zone (Update required)}
\label{\detokenize{ops:number-of-brillouin-zone-update-required}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{BZ number}} : We can specify how many zones are displayed along each reciprocal
lattice vector.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{bz_number}.png}
\end{figure}


\section{Color bar}
\label{\detokenize{ops:color-bar}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Color bar}} : The color bar becomes enable/disable (Fig. \ref{ops:colorbarpng}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{colorbar}.png}
\caption{Toggling the color bar with “Color bar On/Off” menu.}\label{\detokenize{ops:id3}}\label{\detokenize{ops:colorbarpng}}\end{figure}


\section{Color scale mode (Update required)}
\label{\detokenize{ops:color-scale-mode-update-required}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Color scale mode}} : It turns color pattern on Fermi surfaces (Fig. \ref{ops:colorscalepng}).
\begin{description}
\sphinxlineitem{Input (1D) (default for the single input quatity) :}
\sphinxAtStartPar
It makes blue as the minimum on Fermi surfaces and red
as the maximum on them.

\sphinxlineitem{Input (2D) (default for the double input quatity) :}
\sphinxAtStartPar
The color plot is shown with the color circle (see the figure).

\sphinxlineitem{Input (3D) (default for the triple input quatity) :}
\sphinxAtStartPar
The input value is shown as arrows (thin triangles) on the Fermi surfaces.
The color of the Fermi surfaces are the same sa “Band Index” case.

\sphinxlineitem{Fermi velocity (default for no input quantity)}
\sphinxAtStartPar
Compute the Fermi velocity \({\bf v}_{\rm F} = \nabla_k \varepsilon_k\)
with the numerical differentiation of the energy,
and plot the absolute value of that.

\sphinxlineitem{Band Index :}
\sphinxAtStartPar
Fermi surfaces of each band are depicted with uni\sphinxhyphen{}color
without relation to the matrix element.

\sphinxlineitem{Input (1D, Gray), Fermi Velocity (Gray) :}
\sphinxAtStartPar
Plot with gray scale.

\end{description}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Min of Scale}}, \sphinxcode{\sphinxupquote{Max of Scale}} :
We can change the range of the color plot by inputting into the text boxes.
For 3D arrow plot the length of arrows can be changed by \sphinxcode{\sphinxupquote{Max of Scale}}.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Arrow width}} : Change the thickness of arrow (triangle) at “Input (3D)” mode.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{colorscale}.png}
\caption{“Color scale mode” menu.}\label{\detokenize{ops:id4}}\label{\detokenize{ops:colorscalepng}}\end{figure}


\section{Perspective}
\label{\detokenize{ops:perspective}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Perspective}} : Turn on/off the perspective view.


\section{Color sequence for plot}
\label{\detokenize{ops:color-sequence-for-plot}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Bar Color}} :
We can specify the sequence of color plot.
“BGR” is Blue\sphinxhyphen{}Cyan\sphinxhyphen{}Green\sphinxhyphen{}Yellow\sphinxhyphen{}Red,
“CMY” is Cyan\sphinxhyphen{}Blue\sphinxhyphen{}Magenta\sphinxhyphen{}Red\sphinxhyphen{}Yellow,
“MCY” is Magenta\sphinxhyphen{}Blue\sphinxhyphen{}Cyan\sphinxhyphen{}Green\sphinxhyphen{}Yellow.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{bar_color}.png}
\end{figure}


\section{Equator (Update required)}
\label{\detokenize{ops:equator-update-required}}
\sphinxAtStartPar
We can draw the line where
\({\bf v}_{\rm F} \cdot {\bf k} = 0\) for a vector \({\bf k}\).
See fig. \ref{ops:equatorpng}.
When it was created, Kawamura missunderstood that this coinsides the extremul orbit in dHvA
(it is not true!).
Maybe it is related to the ultrasonic attenuation.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Equator}} : We can toggle equator.
This operation does not require the update.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Equator\sphinxhyphen{}v}} :
Modify the direction of the tangent vector \({\bf k}\)
(\sphinxstylestrong{fractional coordinate}).
We need to push \sphinxcode{\sphinxupquote{Update}} to reflect the change.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{equator}.png}
\caption{Display the equator with the “Equator” menu.}\label{\detokenize{ops:id5}}\label{\detokenize{ops:equatorpng}}\end{figure}


\section{Interpolation (Update required)}
\label{\detokenize{ops:interpolation-update-required}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Interpol ratio}} : Smooth the Fermi surface with the interpolation (Fig. \ref{ops:interpolatepng}).
The time for the plot increases with the interpolation ratio.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{interpolate}.png}
\caption{Modify the number of interpolation points from 1 to 4 with “Interpolate” menu.}\label{\detokenize{ops:id6}}\label{\detokenize{ops:interpolatepng}}\end{figure}


\section{Which (or both) side of Fermi surface is illuminated}
\label{\detokenize{ops:which-or-both-side-of-fermi-surface-is-illuminated}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Lighting}} : We can choose the illuminatedside of the Fermi surface (Fig. \ref{ops:lightpng}).
\begin{description}
\sphinxlineitem{Both :}
\sphinxAtStartPar
Light both sides.

\sphinxlineitem{Unoccupy :}
\sphinxAtStartPar
Light unoccupied side.

\sphinxlineitem{Occupy :}
\sphinxAtStartPar
Light the occupied side.

\end{description}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{light}.png}
\caption{Change the lighted side by using the “Lighting” menu.}\label{\detokenize{ops:id7}}\label{\detokenize{ops:lightpng}}\end{figure}


\section{Mouse Drag}
\label{\detokenize{ops:mouse-drag}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Mouse Drag}} : It turns the event of the mouse\sphinxhyphen{}left\sphinxhyphen{}drag.
\begin{description}
\sphinxlineitem{Rotate(default)}
\sphinxAtStartPar
Rotate the figure along the mouse drag.

\sphinxlineitem{Scale}
\sphinxAtStartPar
Expand/shrink the figure in upward/downward drag.

\sphinxlineitem{Translate}
\sphinxAtStartPar
Translate the figure along the mouse drag.

\end{description}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{mouce}.png}
\end{figure}


\section{Nodal line}
\label{\detokenize{ops:nodal-line}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Nodal Line}} : The line on which the matrix element becomes 0 (we call it nodal line)
becomes enable/disable (Fig. \ref{ops:nodelinepng}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{nodeline}.png}
\caption{Toggling the node line with “Nodal line” menu.}\label{\detokenize{ops:id8}}\label{\detokenize{ops:nodelinepng}}\end{figure}


\section{Section of the Brillouine zone (Update required)}
\label{\detokenize{ops:section-of-the-brillouine-zone-update-required}}
\sphinxAtStartPar
Display a 2D plot of the Fermi surface (line)
on an arbitrary section of the Brillouin zone (Fig. \ref{ops:sectionpng}).

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Section}} : We can toggle it with the checkbox
(this operation does not require update).

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Section\sphinxhyphen{}v}} :
We can change the normal vector with the textbox (\sphinxstylestrong{fractional coordinate}).

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{On Gamma}}
If the it is turned on,
the section crosses \(\Gamma\) point.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Section (RGB)}} : Change the color of plane representing the section in BZ.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{section}.png}
\caption{Display 2D plot of the Fermi surface (line) with “Section” menu.}\label{\detokenize{ops:id9}}\label{\detokenize{ops:sectionpng}}\end{figure}


\section{Output section of the Brillouine zone}
\label{\detokenize{ops:output-section-of-the-brillouine-zone}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Section file}} :
Above section of the Brillouin zone and Fermi surfaces are outputted into files “fermi\_line.dat” and “bz\_line.dat” by pushing this button.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{section_file}.png}
\end{figure}

\sphinxAtStartPar
These files are plotted in gnuplot as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{plot}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{fermi\PYGZus{}line.dat}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{n+nb}{w}\PYG{+w}{ }\PYG{n}{l}\PYG{o}{,}\PYG{+w}{ }\PYG{l+s}{\PYGZdq{}}\PYG{l+s}{bz\PYGZus{}line.dat}\PYG{l+s}{\PYGZdq{}}\PYG{+w}{ }\PYG{n+nb}{w}\PYG{+w}{ }\PYG{n}{l}
\end{sphinxVerbatim}


\section{Shift Fermi energy (Update required)}
\label{\detokenize{ops:shift-fermi-energy-update-required}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Fermi energy}} :
It shifts the Fermi energy (= 0 in default) to arbitrary value (Fig. \ref{ops:shiftpng}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{shift}.png}
\caption{The Fermi energy is set from 0 Ry to 0.1 Ry with
“Shift Fermi energy” menu}\label{\detokenize{ops:id10}}\label{\detokenize{ops:shiftpng}}\end{figure}


\section{Stereogram}
\label{\detokenize{ops:stereogram}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Stereogram}} :
The stereogram (parallel eyes and cross eyes) becomes enabled/disabled
(Fig. \ref{ops:stereogrampng}).

\sphinxAtStartPar
None (Default)
\begin{description}
\sphinxlineitem{Parallel}
\sphinxAtStartPar
Parallel\sphinxhyphen{}eyes stereogram

\sphinxlineitem{Cross}
\sphinxAtStartPar
Cross\sphinxhyphen{}eyes stereogram

\end{description}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{stereogram}.png}
\caption{The stereogram becomes enabled/disabled with
“Stereogram” menu.}\label{\detokenize{ops:id11}}\label{\detokenize{ops:stereogrampng}}\end{figure}


\section{Tetrahedron (Update required)}
\label{\detokenize{ops:tetrahedron-update-required}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Tetraghedron}} :
You change the scheme to divide into tetrahedra (\sphinxcode{\sphinxupquote{tetra \# 1}} as default).
It is experimental.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{tetrahedron}.png}
\end{figure}


\section{View point}
\label{\detokenize{ops:view-point}}
\sphinxAtStartPar
Changing the view point.
\begin{description}
\sphinxlineitem{\sphinxcode{\sphinxupquote{Scale}} :}
\sphinxAtStartPar
Change the size of the figure.

\sphinxlineitem{\sphinxcode{\sphinxupquote{Position}} :}
\sphinxAtStartPar
Change the xy position of the figure.

\sphinxlineitem{\sphinxcode{\sphinxupquote{Rotate}} :}
\sphinxAtStartPar
Change angles at x\sphinxhyphen{}, y\sphinxhyphen{}, z\sphinxhyphen{} axis.
Rotations are performed as z\sphinxhyphen{}y\sphinxhyphen{}x axis if the “Roate” buttone is pushed.

\end{description}

\sphinxAtStartPar
In each menu, first the current value is printed. then a prompt to input
the new value appears (Fig. \ref{ops:setviewpng}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{setview}.png}
\caption{Modify the view point by using “View point” menu}\label{\detokenize{ops:id12}}\label{\detokenize{ops:setviewpng}}\end{figure}


\section{Arrow}
\label{\detokenize{ops:arrow}}
\sphinxAtStartPar
Show an arrow (thin triangle) at arbitrary place.
The following are specified in the fractional coordinate.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Arrow (Start)}} : Starting point

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Arrow (End)}} : End point

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Arrow (Diff)}} : Difference of above. \sphinxcode{\sphinxupquote{Arrow (End)}} and \sphinxcode{\sphinxupquote{Arrow (Diff)}} affects each other.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Arrow width}} : Modify the thickness of arrow (triangle).


\section{Wireframe sphere}
\label{\detokenize{ops:wireframe-sphere}}
\sphinxAtStartPar
Show a wireframe sphere at arbitrary place.
This is utilized together with HiLAPW.
The following are specified in the Cartesian coordinate.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Sphere center}} : Center of sphere.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Sphere radius}} : Radius of sphere.


\section{Nesting function}
\label{\detokenize{ops:nesting-function}}
\sphinxAtStartPar
The following two kinds of nesting function are computed and written into a file readable by FermiSurfer.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{delta*delta}} : File name is “doubledelta.frmsf”
\begin{equation*}
\begin{split}\sum_{n n' \textbf{k}} \delta(\varepsilon_{n \textbf{k}}-\varepsilon_\textrm{F})
\delta(\varepsilon_{n' \textbf{k}+\textbf{q}}-\varepsilon_\textrm{F})\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Lindhard}} :  File name is “lindhard.frmsf”
\begin{equation*}
\begin{split}-\sum_{n n' \textbf{k}} \frac{\theta(\varepsilon_\textrm{F} - \varepsilon_{n' \textbf{k}+\textbf{q}})
-\theta(\varepsilon_\textrm{F}-\varepsilon_{n \textbf{k}})}
{\varepsilon_{n' \textbf{k}+\textbf{q}} - \varepsilon_{n \textbf{k}}}\end{split}
\end{equation*}

\section{Saving images}
\label{\detokenize{ops:saving-images}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{fermisurfer}} does not have any functions to save images to a file.
Please use the screenshot on your PC.

\sphinxstepscope


\chapter{Batch mode}
\label{\detokenize{batch:batch-mode}}\label{\detokenize{batch::doc}}
\sphinxAtStartPar
By using “Batch mode”, we can generate an image (PNG) file drawn by FermiSurfer
only with the command\sphinxhyphen{}line operation.
By using this batch mode, we can easily make
\sphinxhref{http://fermisurfer.osdn.jp/table.html}{this kind of many figures.}

\sphinxAtStartPar
For example, in \sphinxcode{\sphinxupquote{example/}} directory, when we execute

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }fermisurfer\PYG{+w}{ }mgb2\PYGZus{}vfz.frmsf\PYG{+w}{ }frmsf.in\PYG{+w}{ }\PYG{l+m}{500}\PYG{+w}{ }\PYG{l+m}{500}
\end{sphinxVerbatim}

\sphinxAtStartPar
we will obtain an image file \sphinxcode{\sphinxupquote{frmsf.in.png}}.
The last two numbers are the width and the height of the window.
\sphinxcode{\sphinxupquote{frmsf.in}} is a configuration file for the batch mode;
its contents are as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{backgroundcolor}  \PYG{l+m+mi}{1} \PYG{l+m+mi}{1} \PYG{l+m+mi}{0}
\PYG{n}{linecolor} \PYG{l+m+mi}{0} \PYG{l+m+mi}{0} \PYG{l+m+mi}{1}
         \PYG{n}{band}  \PYG{l+m+mi}{0} \PYG{l+m+mi}{0} \PYG{l+m+mi}{1}
\PYG{c+c1}{\PYGZsh{}brillouinzone  primitive}
     \PYG{n}{colorbar}  \PYG{l+m+mi}{1}
   \PYG{n}{colorscale}  \PYG{n}{fermivelocity}
       \PYG{n}{minmax}  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{22} \PYG{l+m+mi}{22}
\PYG{c+c1}{\PYGZsh{}      equator  1.0 0.0 0.0}
     \PYG{n}{interpol}  \PYG{l+m+mi}{4}
    \PYG{n}{linewidth}  \PYG{l+m+mf}{3.0}
     \PYG{n}{lighting}  \PYG{n}{both} 
    \PYG{n}{nodalline}  \PYG{l+m+mi}{0}
\PYG{c+c1}{\PYGZsh{}      section  1.0 0.0 0.0}
  \PYG{n}{acrossgamma}  \PYG{l+m+mi}{1}
     \PYG{n}{position}  \PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.0} \PYG{l+m+mf}{0.0}
        \PYG{n}{scale}  \PYG{l+m+mf}{1.0}
     \PYG{n}{rotation}  \PYG{l+m+mf}{120.0} \PYG{l+m+mf}{40.0} \PYG{l+m+mf}{0.0}
  \PYG{n}{fermienergy}  \PYG{l+m+mf}{0.0}
   \PYG{n}{stereogram}  \PYG{n}{none}
  \PYG{n}{tetrahedron}  \PYG{l+m+mi}{1}
\end{sphinxVerbatim}

\sphinxAtStartPar
They are corresponding to the operations in the panel
written in the previos section,
and the available keywords are as follows
(for the ignored keyword, each default value is used) :


\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabular}[t]{\X{10}{100}\X{30}{100}\X{30}{100}\X{30}{100}}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
Keyword
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Available parameter
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Default value
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
background
&
\sphinxAtStartPar
float float float
&
\sphinxAtStartPar
0 0 0
&
\sphinxAtStartPar
Background color
\\
\sphinxhline
\sphinxAtStartPar
band
&
\sphinxAtStartPar
1 or 0 for each band
&
\sphinxAtStartPar
1 1 1 1 …
&
\sphinxAtStartPar
Show(1) or hide(0) each band
\\
\sphinxhline
\sphinxAtStartPar
brillouinzone
&
\sphinxAtStartPar
first, primitive
&
\sphinxAtStartPar
first
&
\sphinxAtStartPar
Kind of the Brillouin zone
\\
\sphinxhline
\sphinxAtStartPar
colorbar
&
\sphinxAtStartPar
0, 1
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
Show(1) or hide (0) the color bar
\\
\sphinxhline
\sphinxAtStartPar
colorscale
&
\sphinxAtStartPar
input1d, input2d, input3d, fermivelocity, bandindex, inputgray, fermivelocitygray
&
\sphinxAtStartPar
input1d
&
\sphinxAtStartPar
Kind of the color plot
\\
\sphinxhline
\sphinxAtStartPar
minmax
&
\sphinxAtStartPar
float float
&
\sphinxAtStartPar
The min. and max. through Fermi surfaces
&
\sphinxAtStartPar
the range of the color scale
\\
\sphinxhline
\sphinxAtStartPar
equator
&
\sphinxAtStartPar
float float float
&
\sphinxAtStartPar
If it is not specified, equator is not shown
&
\sphinxAtStartPar
Tangent vector for equator (fractional coordinate)
\\
\sphinxhline
\sphinxAtStartPar
interpol
&
\sphinxAtStartPar
int
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
Degree of the interpolation
\\
\sphinxhline
\sphinxAtStartPar
linewidth
&
\sphinxAtStartPar
float
&
\sphinxAtStartPar
3.0
&
\sphinxAtStartPar
Line width
\\
\sphinxhline
\sphinxAtStartPar
lighting
&
\sphinxAtStartPar
both, unoccupied, occupied
&
\sphinxAtStartPar
both
&
\sphinxAtStartPar
Which side is illuminated
\\
\sphinxhline
\sphinxAtStartPar
nodalline
&
\sphinxAtStartPar
0, 1
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
Show(1) or hide(0) the nodal line
\\
\sphinxhline
\sphinxAtStartPar
section
&
\sphinxAtStartPar
float float float
&
\sphinxAtStartPar
Section is not shown
&
\sphinxAtStartPar
Normal vector for the section (fractional coordinate)
\\
\sphinxhline
\sphinxAtStartPar
acrossgamma
&
\sphinxAtStartPar
0, 1
&
\sphinxAtStartPar
1
&
\sphinxAtStartPar
Whether math:\sphinxtitleref{\{rm Gamma\}} is included (1) or not (0) in the section.
\\
\sphinxhline
\sphinxAtStartPar
position
&
\sphinxAtStartPar
float float
&
\sphinxAtStartPar
0.0, 0.0
&
\sphinxAtStartPar
The position of the figure
\\
\sphinxhline
\sphinxAtStartPar
scale
&
\sphinxAtStartPar
float
&
\sphinxAtStartPar
1.0
&
\sphinxAtStartPar
The scale of the figure
\\
\sphinxhline
\sphinxAtStartPar
rotation
&
\sphinxAtStartPar
float float float
&
\sphinxAtStartPar
0.0, 0.0, 0.0
&
\sphinxAtStartPar
Rotation arround x\sphinxhyphen{}, y\sphinxhyphen{}, and z\sphinxhyphen{}axis
\\
\sphinxhline
\sphinxAtStartPar
fermienergy
&
\sphinxAtStartPar
float
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
Fermi energy
\\
\sphinxhline
\sphinxAtStartPar
stereogram
&
\sphinxAtStartPar
none, parallel, cross
&
\sphinxAtStartPar
none
&
\sphinxAtStartPar
Stereogram
\\
\sphinxhline
\sphinxAtStartPar
tetrahedron
&
\sphinxAtStartPar
int from 0 to 15
&
\sphinxAtStartPar
0
&
\sphinxAtStartPar
Direction to cut tetrahedra
\\
\sphinxbottomrule
\end{tabular}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This function uses “import” command to get the screen\sphinxhyphen{}shot in ImageMagic.
Therefore ImageMagic have to be installed to use this function.
\end{sphinxadmonition}

\sphinxstepscope


\chapter{Tutorial with Quantum ESPRESSO}
\label{\detokenize{qe:tutorial-with-quantum-espresso}}\label{\detokenize{qe::doc}}
\sphinxAtStartPar
Since the version 6.2, Quantum ESPRESSO can generate data\sphinxhyphen{}files
for FermiSurfer.
The following quantities can be displayed through FermiSurfer.
\begin{itemize}
\item {} 
\sphinxAtStartPar
The absolute value of the Fermi velocity \(|{\bf v}_{\rm F}|\) (\sphinxcode{\sphinxupquote{fermi\_velocity.x}}).

\item {} 
\sphinxAtStartPar
The projection onto each atomic orbital
\(|\langle \phi_{n l m} | \psi_{n k} \rangle|^2\) (\sphinxcode{\sphinxupquote{fermi\_proj.x}})

\end{itemize}


\section{Building \sphinxstyleliteralintitle{\sphinxupquote{PostProcess}}  tool}
\label{\detokenize{qe:building-postprocess-tool}}
\sphinxAtStartPar
For displaying the above quantities with FermiSurfer,
we have to build \sphinxcode{\sphinxupquote{PostProcess}} tools
(tools for plotting the band structure, the charge density, etc.)
in QuantumESPRESSO as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }make\PYG{+w}{ }pp
\end{sphinxVerbatim}


\section{SCF calculation}
\label{\detokenize{qe:scf-calculation}}
\sphinxAtStartPar
Now we will move on the tutorial.
First, we perform the electronic\sphinxhyphen{}structure calculation with \sphinxcode{\sphinxupquote{pw.x}}.
We will treat MgB$_{\text{2}}$ in this tutorial.
The input file is as follows.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{scf.in}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZam{}}\PYG{n}{CONTROL}
 \PYG{n}{calculation} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{scf}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
  \PYG{n}{pseudo\PYGZus{}dir} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{prefix} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mgb2}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,}
      \PYG{n}{outdir} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{o}{/}
\PYG{o}{\PYGZam{}}\PYG{n}{SYSTEM}
       \PYG{n}{ibrav} \PYG{o}{=} \PYG{l+m+mi}{4}\PYG{p}{,}
   \PYG{n}{celldm}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{=} \PYG{l+m+mf}{5.808563789}\PYG{p}{,}
   \PYG{n}{celldm}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{=} \PYG{l+m+mf}{1.145173082}\PYG{p}{,}
         \PYG{n}{nat} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{,}
        \PYG{n}{ntyp} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{,}
     \PYG{n}{ecutwfc} \PYG{o}{=} \PYG{l+m+mf}{50.0} \PYG{p}{,}
     \PYG{n}{ecutrho} \PYG{o}{=} \PYG{l+m+mf}{500.0} \PYG{p}{,}
 \PYG{n}{occupations} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tetrahedra\PYGZus{}opt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{/}
\PYG{o}{\PYGZam{}}\PYG{n}{ELECTRONS}
\PYG{o}{/}
\PYG{n}{ATOMIC\PYGZus{}SPECIES}
 \PYG{n}{Mg}    \PYG{l+m+mf}{24.3050}   \PYG{n}{Mg}\PYG{o}{.}\PYG{n}{pbe}\PYG{o}{\PYGZhy{}}\PYG{n}{n}\PYG{o}{\PYGZhy{}}\PYG{n}{kjpaw\PYGZus{}psl}\PYG{l+m+mf}{.0}\PYG{l+m+mf}{.3}\PYG{l+m+mf}{.0}\PYG{o}{.}\PYG{n}{upf}
  \PYG{n}{B}    \PYG{l+m+mf}{10.811}    \PYG{n}{B}\PYG{o}{.}\PYG{n}{pbe}\PYG{o}{\PYGZhy{}}\PYG{n}{n}\PYG{o}{\PYGZhy{}}\PYG{n}{kjpaw\PYGZus{}psl}\PYG{l+m+mf}{.0}\PYG{l+m+mf}{.1}\PYG{o}{.}\PYG{n}{upf}
\PYG{n}{ATOMIC\PYGZus{}POSITIONS} \PYG{n}{crystal}
 \PYG{n}{Mg}    \PYG{l+m+mf}{0.000000000}    \PYG{l+m+mf}{0.000000000}    \PYG{l+m+mf}{0.000000000}    
  \PYG{n}{B}    \PYG{l+m+mf}{0.333333333}    \PYG{l+m+mf}{0.666666667}    \PYG{l+m+mf}{0.500000000}    
  \PYG{n}{B}    \PYG{l+m+mf}{0.666666667}    \PYG{l+m+mf}{0.333333333}    \PYG{l+m+mf}{0.500000000}    
\PYG{n}{K\PYGZus{}POINTS} \PYG{n}{automatic} 
\PYG{l+m+mi}{16} \PYG{l+m+mi}{16} \PYG{l+m+mi}{12} \PYG{l+m+mi}{0} \PYG{l+m+mi}{0} \PYG{l+m+mi}{0}
\end{sphinxVerbatim}

\sphinxAtStartPar
Pseudopotentials used in this example are included in
\sphinxhref{http://theossrv1.epfl.ch/Main/Pseudopotentials}{PS Library},
and they can be downloaded from the following address:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxurl{http://theossrv1.epfl.ch/uploads/Main/NoBackup/Mg.pbe-n-kjpaw\_psl.0.3.0.upf}

\item {} 
\sphinxAtStartPar
\sphinxurl{http://theossrv1.epfl.ch/uploads/Main/NoBackup/B.pbe-n-kjpaw\_psl.0.1.upf}

\end{itemize}

\sphinxAtStartPar
We put the input file and the pseudopotential in the same directory,
and run \sphinxcode{\sphinxupquote{pw.x}} at that directory.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }mpiexec\PYG{+w}{ }\PYGZhy{}np\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }pw.x\PYG{+w}{ }\PYGZhy{}npool\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}in\PYG{+w}{ }scf.in
\end{sphinxVerbatim}

\sphinxAtStartPar
the number of processes and the number of blocks for \sphinxstyleemphasis{k}\sphinxhyphen{}paralleliztion (\sphinxcode{\sphinxupquote{npool}})
can be arbitlary numbers.
We also can perform additional non\sphinxhyphen{}scf calcultion with a different \sphinxstyleemphasis{k}\sphinxhyphen{}grid.


\section{Compute and display Fermi velocity}
\label{\detokenize{qe:compute-and-display-fermi-velocity}}
\sphinxAtStartPar
We run \sphinxcode{\sphinxupquote{fermi\_velocity.x}} program with the same input file as \sphinxcode{\sphinxupquote{pw.x}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }mpiexec\PYG{+w}{ }\PYGZhy{}np\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }fermi\PYGZus{}velocity.x\PYG{+w}{ }\PYGZhy{}npool\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}in\PYG{+w}{ }scf.in
\end{sphinxVerbatim}

\sphinxAtStartPar
For this calculation, the number of blocks for \sphinxstyleemphasis{k}\sphinxhyphen{}paralleliztion (\sphinxcode{\sphinxupquote{npool}})
should be 1 (or not specified).
Then, the file for the Fermi velocity, \sphinxcode{\sphinxupquote{vfermi.frmsf}}, is generated;
this file can be read from FermiSurfer as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }fermisurfer\PYG{+w}{ }vfermi.frmsf
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=0.300\linewidth]{{qe_vf}.png}
\end{figure}

\sphinxAtStartPar
For the case of the collinear spin calculation,
two files, \sphinxcode{\sphinxupquote{vfermi1.frmsf}} and \sphinxcode{\sphinxupquote{vfermi2.frmsf}} associated
to each spin are generated.


\section{Compute and display projection onto the atomic orbital}
\label{\detokenize{qe:compute-and-display-projection-onto-the-atomic-orbital}}
\sphinxAtStartPar
Then we will computeb the projection onto the atomic orbital.
First we run \sphinxcode{\sphinxupquote{projwfc.x}} with the following input file:

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{proj.in}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZam{}}\PYG{n}{PROJWFC}
   \PYG{n}{outdir} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{prefix}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mgb2}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{Emin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.3422}\PYG{p}{,} 
    \PYG{n}{Emax}\PYG{o}{=}\PYG{l+m+mf}{10.0578}\PYG{p}{,} 
    \PYG{n}{DeltaE}\PYG{o}{=}\PYG{l+m+mf}{0.1}
\PYG{o}{/}
\PYG{l+m+mi}{2}
\PYG{l+m+mi}{6} \PYG{l+m+mi}{10}
\end{sphinxVerbatim}

\sphinxAtStartPar
The input dates after the end of the name\sphinxhyphen{}list \sphinxcode{\sphinxupquote{PROJWFC}} (\sphinxcode{\sphinxupquote{/}})
is not used by \sphinxcode{\sphinxupquote{projwfc.x}}.
The number of processes and the number of blocks for
the \sphinxstyleemphasis{k}\sphinxhyphen{}parallelization (\sphinxcode{\sphinxupquote{npool}}) must to be the same as those
for the execution of \sphinxcode{\sphinxupquote{pw.x}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }mpiexec\PYG{+w}{ }\PYGZhy{}np\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }projwfc.x\PYG{+w}{ }\PYGZhy{}npool\PYG{+w}{ }\PYG{l+m}{4}\PYG{+w}{ }\PYGZhy{}in\PYG{+w}{ }proj.in
\end{sphinxVerbatim}

\sphinxAtStartPar
excepting \sphinxcode{\sphinxupquote{wf\_collect=.true.}} in the input of \sphinxcode{\sphinxupquote{pw.x}}.

\sphinxAtStartPar
the following description can be found
in the beginning of the standard output of \sphinxcode{\sphinxupquote{projwfc.x}}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Atomic} \PYG{n}{states} \PYG{n}{used} \PYG{k}{for} \PYG{n}{projection}
\PYG{p}{(}\PYG{n}{read} \PYG{k+kn}{from} \PYG{n+nn}{pseudopotential} \PYG{n}{files}\PYG{p}{)}\PYG{p}{:}

\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   1: atom   1 (Mg ), wfc  1 (l=0 m= 1)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   2: atom   1 (Mg ), wfc  2 (l=1 m= 1)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   3: atom   1 (Mg ), wfc  2 (l=1 m= 2)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   4: atom   1 (Mg ), wfc  2 (l=1 m= 3)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   5: atom   2 (B  ), wfc  1 (l=0 m= 1)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   6: atom   2 (B  ), wfc  2 (l=1 m= 1)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   7: atom   2 (B  ), wfc  2 (l=1 m= 2)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   8: atom   2 (B  ), wfc  2 (l=1 m= 3)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}   9: atom   3 (B  ), wfc  1 (l=0 m= 1)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}  10: atom   3 (B  ), wfc  2 (l=1 m= 1)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}  11: atom   3 (B  ), wfc  2 (l=1 m= 2)}
\PYG{n}{state} \PYG{c+c1}{\PYGZsh{}  12: atom   3 (B  ), wfc  2 (l=1 m= 3)}
\end{sphinxVerbatim}

\sphinxAtStartPar
This indicates the relationship between the index of the atomic orbital (\sphinxcode{\sphinxupquote{state \#}})
and its character (for more details, please see \sphinxcode{\sphinxupquote{INPUT\_PROJWFC.html}} in QE).
When we choose the projection onto the atomic orbital plotted on the Fermi surface,
we use this index.
For example, we run \sphinxcode{\sphinxupquote{fermi\_proj.x}} with above \sphinxcode{\sphinxupquote{proj.in}} as an input file,

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }mpiexec\PYG{+w}{ }\PYGZhy{}np\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }fermi\PYGZus{}proj.x\PYG{+w}{ }\PYGZhy{}npool\PYG{+w}{ }\PYG{l+m}{1}\PYG{+w}{ }\PYGZhy{}in\PYG{+w}{ }proj.in
\end{sphinxVerbatim}

\sphinxAtStartPar
and we obtain the data\sphinxhyphen{}file for FermiSurfer, \sphinxcode{\sphinxupquote{proj.frmsf}}.
In this case, after \sphinxcode{\sphinxupquote{/}} in \sphinxcode{\sphinxupquote{proj.in}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{2}
\PYG{l+m+mi}{6} \PYG{l+m+mi}{10}
\end{sphinxVerbatim}

\sphinxAtStartPar
we specify the total number of the displayed projection onto the atomic orbital
as the first value (\sphinxcode{\sphinxupquote{2}}) and projections to be summed as
following indices.
In this input, the sum of the 2pz of the first B atom (\sphinxcode{\sphinxupquote{6}})
and the 2pz of the first B atom (\sphinxcode{\sphinxupquote{10}}),
\begin{equation*}
\begin{split}|\langle \phi_{B_1 2pz} | \psi_{nk} \rangle|^2
+ |\langle \phi_{B_2 2pz} | \psi_{nk} \rangle|^2\end{split}
\end{equation*}
\sphinxAtStartPar
is specified. We can display the Fermi surface as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }fermisurfer\PYG{+w}{ }proj.frmsf
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=0.300\linewidth]{{qe_proj_pz}.png}
\end{figure}

\sphinxAtStartPar
If we want to plot the projections onto 2px and 2py orbitals of all B atoms,
the input file for \sphinxcode{\sphinxupquote{fermi\_proj.x}} becomes

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{\PYGZam{}}\PYG{n}{PROJWFC}
\PYG{n}{outdir} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{./}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{prefix}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mgb2}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{Emin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.3422}\PYG{p}{,}
\PYG{n}{Emax}\PYG{o}{=}\PYG{l+m+mf}{10.0578}\PYG{p}{,}
\PYG{n}{DeltaE}\PYG{o}{=}\PYG{l+m+mf}{0.1}
\PYG{o}{/}
\PYG{l+m+mi}{4}
\PYG{l+m+mi}{7} \PYG{l+m+mi}{8} \PYG{l+m+mi}{11} \PYG{l+m+mi}{12}
\end{sphinxVerbatim}

\sphinxAtStartPar
We do not have to run \sphinxcode{\sphinxupquote{projwfc.x}} again.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=0.300\linewidth]{{qe_proj_pxy}.png}
\end{figure}

\sphinxstepscope


\chapter{FermiSurfer on Web}
\label{\detokenize{onweb:fermisurfer-on-web}}\label{\detokenize{onweb::doc}}
\sphinxAtStartPar
We can use FermiSurfer on Web at the following URL:
\sphinxurl{https://fermisurfer.osdn.jp/js/index.php}


\section{Control FermiSurfer on Web}
\label{\detokenize{onweb:control-fermisurfer-on-web}}
\sphinxAtStartPar
Although we are planning to port all functions of {\hyperref[\detokenize{ops:ops}]{\sphinxcrossref{\DUrole{std,std-ref}{the app version of Fermisurfer}}}},
part of them have not been supported yet.


\section{How to input file}
\label{\detokenize{onweb:how-to-input-file}}
\sphinxAtStartPar
Fermi surfaces are displayed by choosing a local FRMSF file (BXSF is not supported yet)
through the file\sphinxhyphen{}explore at left top of the window.
Several time\sphinxhyphen{}lag may be expected.


\section{Open online file}
\label{\detokenize{onweb:open-online-file}}
\sphinxAtStartPar
We can open an input file placed online by just clicking the link by a URL with an argument:

\sphinxAtStartPar
\sphinxurl{https://fermisurfer.osdn.jp/js/index.php?frmsf=https://fermisurfer.osdn.jp/js/Pb.js}

\sphinxAtStartPar
We add the URL where the input file locates after \sphinxcode{\sphinxupquote{https://fermisurfer.osdn.jp/js/index.php?frmsf=}}.
This function can be used in research\sphinxhyphen{}introduction pages.

\sphinxAtStartPar
The input file \sphinxcode{\sphinxupquote{Pb.js}} is as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nx}{frmsf}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}16 16 16 1 2 \PYGZhy{}0.67303315756516724 0.67303315756516724 ... \PYGZdq{}}\PYG{p}{;}
\end{sphinxVerbatim}

\sphinxAtStartPar
This is a javascript source in which
a single\sphinxhyphen{}lined string generated by replacing new\sphinxhyphen{}line letters in {\hyperref[\detokenize{input:input}]{\sphinxcrossref{\DUrole{std,std-ref}{FRMSF\sphinxhyphen{}formatted file}}}} with spaces
is inputted into a variable \sphinxcode{\sphinxupquote{frmsf}}.
BXSF format has not been supported.

\sphinxAtStartPar
We can convert a FRMSF\sphinxhyphen{}formatted file into the above format as

\begin{sphinxVerbatim}[commandchars=\\\{\}]
sed\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}1i frmsf=\PYGZdq{}\PYGZsq{}}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}\PYGZdl{}a \PYGZdq{};\PYGZsq{}}\PYG{+w}{ }ANY.frmsf\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }perl\PYG{+w}{ }\PYGZhy{}pe\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZbs{}n/ /g\PYGZsq{}}\PYG{+w}{ }\PYG{p}{|}\PYG{+w}{ }sed\PYG{+w}{ }\PYGZhy{}E\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/ +/ /g\PYGZsq{}}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/\PYGZdq{} /\PYGZdq{}/g\PYGZsq{}}\PYG{+w}{ }\PYGZhy{}e\PYG{+w}{ }\PYG{l+s+s1}{\PYGZsq{}s/ \PYGZdq{}/\PYGZdq{}/g\PYGZsq{}}\PYG{+w}{ }\PYGZgt{}\PYG{+w}{ }ANY.js
\end{sphinxVerbatim}

\sphinxAtStartPar
The following bash script file also do this conversion

\sphinxAtStartPar
\sphinxurl{https://fermisurfer.osdn.jp/js/frmsf2js.sh}

\sphinxAtStartPar
Usage:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYGZdl{}\PYG{+w}{ }bash\PYG{+w}{ }frmsf2js.sh\PYG{+w}{ }ANY.frmsf
\end{sphinxVerbatim}

\sphinxAtStartPar
where ANY is an arbitrary string.
Then a file \sphinxcode{\sphinxupquote{ANY.js}} which should be uploaded onto an Web server is generated.

\sphinxstepscope


\chapter{Acknowledgment}
\label{\detokenize{ack:acknowledgment}}\label{\detokenize{ack::doc}}
\sphinxAtStartPar
I thank Dr. Yusuke Konishi in ISSP; he performed a test in Mac OSX, and
proposed Makefiles and a patch.

\sphinxstepscope


\chapter{Re\sphinxhyphen{}distribution of this program}
\label{\detokenize{copy:re-distribution-of-this-program}}\label{\detokenize{copy::doc}}

\section{Contain Fermisurfer in your program}
\label{\detokenize{copy:contain-fermisurfer-in-your-program}}
\sphinxAtStartPar
FermiSurfer is distributed with the {\hyperref[\detokenize{copy:mitlicense}]{\sphinxcrossref{\DUrole{std,std-ref}{MIT License}}}}.
To summarize this, you can freely modify, copy and paste FermiSurfer to any program
such as a private program (in the research group, co\sphinxhyphen{}workers, etc.),
open\sphinxhyphen{}source, free, and commercial software.
Also, you can freely choose the license to distribute your program.


\section{MIT License}
\label{\detokenize{copy:mit-license}}\label{\detokenize{copy:mitlicense}}
\begin{DUlineblock}{0em}
\item[] Copyright (c) 2014 Mitsuaki Kawamura
\item[] 
\item[] Permission is hereby granted, free of charge, to any person obtaining a
\item[] copy of this software and associated documentation files (the
\item[] “Software”), to deal in the Software without restriction, including
\item[] without limitation the rights to use, copy, modify, merge, publish,
\item[] distribute, sublicense, and/or sell copies of the Software, and to
\item[] permit persons to whom the Software is furnished to do so, subject to
\item[] the following conditions:
\item[] 
\item[] The above copyright notice and this permission notice shall be included
\item[] in all copies or substantial portions of the Software.
\item[] 
\item[] THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS
\item[] OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
\item[] MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
\item[] IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
\item[] CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
\item[] TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
\item[] SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
\end{DUlineblock}

\sphinxstepscope


\chapter{Contact}
\label{\detokenize{contact:contact}}\label{\detokenize{contact::doc}}
\sphinxAtStartPar
Please post bag reports and questions to the forum

\sphinxAtStartPar
\sphinxurl{https://github.com/mitsuaki1987/fermisurfer/issues}

\sphinxAtStartPar
When you want to join us, please contact me as follows.

\sphinxAtStartPar
The Institute of Solid State Physics

\sphinxAtStartPar
Mitsuaki Kawamura

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{mkawamura\_\_at\_\_ds.itc.u\sphinxhyphen{}tokyo.ac.jp}}



\renewcommand{\indexname}{Index}
\printindex
\end{document}